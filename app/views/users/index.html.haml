- @title = 'Users'

- content_for :body_class do
  brand-background

- content_for :header do
  .header-container
    .container
      %h1.page-heading
        .pull-right
          = render 'layouts/per_page', per_page: 40, object_count: @users.total_count
        = @title
        = render 'search/toggle'

= render 'search/simple', url: users_path

.dashboard-container
  %table.table.table-striped.table-borderless.table-hover
    %col
    %col
    %col.hidden-xs
    %col.hidden-xs
    %col{ width: '1px' }
    %thead
      %tr
        = th_sort_field @order, 'users.last_name', 'Name'
        = th_sort_field @order, 'users.email', 'Email'
        = th_sort_field_rev @order, 'users.current_sign_in_at', 'Recent Activity', extra_class: 'hidden-xs'
        = th_sort_field_rev @order, 'users.sign_in_count', 'Sign in Count', extra_class: 'hidden-xs text-right'
        %th.center
          %span.hidden-xs Actions
    - @users.each do |user|
      %tr{ id: "user-#{user.id}-container", class: "#{'banned' if current_user.system_admin? && user.banned?}" }
        %td.nowrap
          = image_tag user.avatar_url(18), style: 'min-width: 18px;', size: '18x18', alt: ''
          %span.hidden-xs.hidden-sm= link_to user.name, user
        %td
          %span.hidden-xs{ style: 'word-break: break-word;' }= user.email
          %span.hidden-sm.hidden-md.hidden-lg= link_to user.email, user, style: 'word-break: break-word;'
        %td.hidden-xs
          - if user.current_sign_in_at
            = time_ago_in_words(user.current_sign_in_at)
            ago
        %td.hidden-xs.text-right= number_with_delimiter(user.sign_in_count)
        %td
          .dropdown
            = link_to '#', class: 'btn btn-default btn-xs dropdown-toggle', data: { toggle: 'dropdown' } do
              %span.hidden-sm.hidden-md.hidden-lg.glyphicon.glyphicon-cog
              %span.hidden-xs Actions
              %strong.caret

            %ul.dropdown-menu.dropdown-menu-right
              %li
                = link_to edit_user_path(user) do
                  %span.glyphicon.glyphicon-edit
                  Edit
              %li.divider{ role: 'separator' }
              %li
                = link_to user, method: :delete, remote: true, data: { confirm: "Delete #{user.name}?" } do
                  .text-danger
                    %span.glyphicon.glyphicon-trash
                    Delete

.center= paginate @users, theme: 'bootstrap'
