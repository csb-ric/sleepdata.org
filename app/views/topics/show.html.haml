- @title = @topic.title

- content_for :header do
  / .background-gradient
  .header-container
    .container
      %h1.page-heading
        .pull-right
          = link_to reply_or('Write a Reply'), page_topic_path(@topic, page: @topic.last_page, anchor: 'write-a-reply'), method: :get, class: 'btn btn-accent btn-shadow'
        =# render 'layouts/side_nav_header_button'
        = @title
  .breadcrumb-container{ style: 'margin-bottom: 0;' }
    .container
      Topic by
      = @topic.user.forum_name

      - if @topic.tags.count > 0
        - @topic.tags.each do |tag|
          %span.label.label-default{ style: "background-color:#{tag.color}" }= tag.name

      - if current_user && @topic.editable_by?(current_user)
        .pull-right= render 'layouts/edit_delete_dropdown', edit_url: edit_topic_path(@topic), delete_url: @topic, delete_confirmation: "Delete #{@topic.title}?"


%div{ style: 'margin-bottom: 20px' }
  .pull-right.hidden-xs.hidden-sm{ style: 'margin-top: -20px' }
    = paginate @replies, theme: 'bootstrap-small'

%div{ style: 'clear:both' }

= render 'replies/index', parent: @topic

- if @page == @topic.last_page
  #comment_container_root_new{ style: 'display:none' }
    - reply = @topic.replies.new
    = render 'replies/form', reply: reply

  %a.anchor{ name: 'write-a-reply' }
  #write_reply_root_new{ style: 'margin-bottom: 20px' }
    - async_write_a_reply_path = async_parent_reply_path(topic_id: @topic, parent_reply_id: 'root', reply_id: 'new')
    = link_to 'Write a Reply', async_write_a_reply_path, method: :post, remote: true, class: 'btn btn-primary'

.center= paginate @replies, theme: 'bootstrap-small'

- if current_user
  - content_for :call_to_action do
    %div{ style: 'background-color: #ededed' }
      .container
        #topic-subscription= render 'topics/subscribe_unsubscribe', topic: @topic
