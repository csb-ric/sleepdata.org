- @title = "#{"#{params[:folder].gsub('/', ' - ')} - " if params[:folder].present?} #{@dataset.slug.upcase} Variables"

- content_for :body_class do
  brand-background

= render 'datasets/header'

= render 'variables/folder_breadcrumb', folder: params[:folder]

= render 'search/simple', url: dataset_variables_path(@dataset)

- if @variables.count > 0
  .dashboard-container
    %table.table.table-striped
      %col{ width: "32px" }
      %col
      %col
      %col
      - if params[:search].present?
        %col
      %thead
        %tr
          %th
          %th
            Name
            = render 'search/toggle'
          %th.hidden-xs.nowrap Display Name
          %th.hidden-xs.hidden-sm Folder
          - if params[:search].present?
            %th Relevance

      - @variables.sort { |a,b| a.rank_sort_order(params[:search]) <=> b.rank_sort_order(params[:search]) }.each do |variable|
        %tr
          %td
            - if variable.commonly_used?
              %span.glyphicon.glyphicon-star.text-warning
          %td
            = link_to variable.name, dataset_variable_path(variable.dataset, variable)
            .hidden-sm.hidden-md.hidden-lg
              = variable.display_name
          %td.hidden-xs
            = variable.display_name
            %small.text-muted.variable-description= simple_markdown_new(variable.description, allow_lists: false)
          %td.hidden-xs.hidden-sm= variable.folder
          - if params[:search].present?
            %td= render 'variables/relevance', variable: variable
- elsif @dataset.variables.count == 0
  .jumbotron{ style: 'margin-top:30px' }
    %p
      We have not yet generated graphs for variables in this dataset.
    %p
      Please contact us directly at
      = mail_to 'support@sleepdata.org'
      with any questions.
- else
  .jumbotron{ style: 'margin-top:30px' }
    %p
      No variables found matching
      = succeed '.' do
        %code= params[:search]
    %p
      Please contact us directly at
      = mail_to 'support@sleepdata.org'
      with any questions.
