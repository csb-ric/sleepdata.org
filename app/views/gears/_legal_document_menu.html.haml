.col-12.col-md-3.col-xl-2.sidebar-wrapper
  .sidebar
    .sidebar-header.d-flex.align-items-center
      .mr-auto
        %strong= @legal_document.organization.name

      %button.btn-link.sidebar-header-toggle.d-md-none.p-0.ml-3{ type: "button", data: { toggle: "collapse", target: "#sidebar-nav-wrapper" }, aria: { controls: "sidebar-nav-wrapper", expanded: "false", label: "Toggle docs navigation" } }
        %i.fa.fa-bars.fa-2x

    -# groups = [{name: "DAUA", url: legal_template_three_organization_path(@organization), docs: [{ name: "Page 1", url: legal_template_three_organization_path(@organization) },{ name: "Page 2", url: legal_template_four_organization_path(@organization) },{ name: "Page 3", url: legal_template_five_organization_path(@organization) },{ name: "Page 4", url: legal_template_six_organization_path(@organization) }] }, {name: "Riders", url: legal_template_seven_organization_path(@organization), docs: [{ name: "IRB Review", url: legal_template_seven_organization_path(@organization) }] }, {name: "Proof", url: legal_template_eight_organization_path(@organization), docs: [{ name: "Review", url: legal_template_eight_organization_path(@organization) }] }]

    - pages = @legal_document.legal_document_pages.where(rider: false).collect { |p| { name: "Page #{p.position}", url: agreement_page_path(page: p.position, dataset_id: @dataset, legal_document_id: @legal_document) } }
    - riders = @legal_document.legal_document_pages.where(rider: true).collect { |p| { name: p.title, url: agreement_page_path(page: p.position, dataset_id: @dataset, legal_document_id: @legal_document) } }
    - groups = []
    - groups << { name: "DAUA", url: agreement_page_path(page: 1, dataset_id: @dataset, legal_document_id: @legal_document), docs: pages } if pages.present?
    - groups << { name: "Attest", url: agreement_attest_path(dataset_id: @dataset, legal_document_id: @legal_document), docs: [{ name: "Attest", url: agreement_attest_path(dataset_id: @dataset, legal_document_id: @legal_document) }] } if @legal_document.attestation_type == "checkbox"
    - groups << { name: "Signature", url: agreement_signature_path(dataset_id: @dataset, legal_document_id: @legal_document), docs:[{ name: "Signature", url: agreement_signature_path(dataset_id: @dataset, legal_document_id: @legal_document) }] } if @legal_document.attestation_type == "signature"
    - groups << { name: "Riders", url: riders.first[:url], docs: riders } if riders.present?



    - random_number = rand(groups.size)

    #sidebar-nav-wrapper.sidebar-nav-wrapper.collapse
      %nav.sidebar-nav
        - groups.each_with_index do |group, group_index|
          .sidebar-nav-group{ class: random_number == group_index || true ? "active" : nil }
            %a.sidebar-nav-group-link{ href: group.dig(:url) }
              = group.dig(:name)

            - if group.dig(:docs).present?
              - random_docs_number = rand(group.dig(:docs).size)
              %ul.nav.sidebar-nav-group-items
                - group.dig(:docs).each_with_index do |doc, doc_index|
                  %li{ class: current_page?(doc.dig(:url)) ? "active" : nil }
                    %a{ href: doc.dig(:url) }
                      - if doc_index == 0
                        %i.fa.fa-check-square-o.text-success
                      - else
                        %i.fa.fa-square-o
                      = doc.dig(:name)
