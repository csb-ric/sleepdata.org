.container-fluid
  .row.flex-xl-nowrap
    = render "gears/legal_document_menu"

    #agreement-helper-drawer.d-none.d-xl-block.col-xl.sidebar-drawer

    %main.col-12.col-md-9.col-xl-8.pl-md-5{ role: "main" }
      .page-box.last-box
        .agreement-heading Signature

        = form_with url: update_agreement_signature_path(dataset_id: @dataset, legal_document_id: @final_legal_document.legal_document), method: :post, local: true, id: "final-legal-document-form" do |form|
          = hidden_field_tag :data_uri

          #signature-pad.signature-pad
            .signature-pad-header
              = link_to "#", data: { action: "clear" }, class: "small" do
                %i.fa.fa-eraser
                %span Clear
                %span.d-none.d-sm-inline Signature
            .signature-pad-body.background-p200-green{ id: "signature-pad-body", data: { object: "text-input-expandable", help_element: "signature-pad-body", help_text: "Signature" } }
              .signature-pad-body-sign-here.small
                Sign here
              %canvas
            .signature-pad-footer
              .text-center.sign-with-mouse
                %small.text-muted
                  Sign by holding the left mouse button down in the signature box.
                  Press
                  %strong Clear Signature
                  to try again.
              .text-center.sign-with-finger
                %small.text-muted
                  Sign using your finger in the signature box.
                  Press
                  %strong Clear Signature
                  to try again.

          - [{variable: "signature_name", label: "By (print name)", type: "string" }].each do |hash|
            .form-group
              = label_tag hash[:variable], hash[:label], class: "form-control-label"
              - if hash[:type] == "text"
                = text_area_tag hash[:variable], "", class: "form-control input-expandable", placeholder: "<required>", data: { object: "text-input-expandable", help_element: hash[:variable], help_text: hash[:label] || hash[:variable].titleize }, rows: 7
              - else
                = text_field_tag hash[:variable], "", class: "form-control input-expandable", placeholder: "<required>", data: { object: "text-input-expandable", help_element: hash[:variable], help_text: hash[:label] || hash[:variable].titleize }
              - if hash[:example].present?
                %small.text-muted= hash[:example]

        .mt-5.mb-3.float-right
          = succeed " " do
            = link_to "#", class: "btn btn-light", tabindex: "-1", data: { object: "submit-signature", target: "#final-legal-document-form" } do
              %i.fa.fa-save
              Save Draft

          = link_to "#", class: "btn btn-primary", data: { object: "submit-signature", target: "#final-legal-document-form" } do
            Proceed
            %i.fa.fa-caret-right
