- @title = 'Datasets'

- content_for :body_class do
  brand-background

- content_for :header do
  .background-gradient
  .header-container
    .container
      %h1.page-heading
        .pull-right
          = link_to plus_or('Create Dataset'), new_dataset_path, class: 'btn btn-accent btn-shadow' if current_user && current_user.system_admin?
          = render 'layouts/per_page', per_page: 24, object_count: @datasets.total_count
        =# render 'layouts/side_nav_header_button'
        = @title

- @datasets.each do |dataset|
  .dataset-card{ id: "dataset-card-#{dataset.id}" }
    .dataset-card-header
      = render 'datasets/card_icon', dataset: dataset
      %div{ style: 'padding: 10px;flex: 1' }
        .pull-right
          %span{ style: 'color: #ccc;' }
            %span.hidden-xs Reviews
            = surround '(', ')' do
              = link_to number_with_delimiter(dataset.dataset_reviews.count), dataset_dataset_reviews_path(dataset)
          = render 'datasets/rating', rating: dataset.rating
        = link_to dataset.name, dataset

    .dataset-card-body
      .not-flipped
        - logo_size = '100px'
        - if dataset.logo.size > 0
          %div{ style: "width: #{logo_size};margin: auto;" }
            = link_to image_tag(logo_dataset_path(dataset), style: "max-width: 100%;max-height: #{logo_size};"), dataset
        = render 'datasets/card_content', dataset: dataset
      .already-flipped
        = simple_markdown(dataset.description)
    %div{ style: 'background-color: #ededed;padding: 10px;' }
      - if dataset.description.present?
        .pull-left
          = link_to '#', data: { object: 'flip-card', target: "#dataset-card-#{dataset.id}" } do
            Details
            %span.glyphicon.glyphicon-menu-down
      .dataset-card-footer
        %span.hidden-xs{ style: 'color: #ccc;' } View
        .dataset-card-footer-entry
          = link_to dataset, class: 'no-underline' do
            Docs
        .dataset-card-footer-spacer|
        .dataset-card-footer-entry
          = link_to files_dataset_path(dataset), class: 'no-underline' do
            Files
        .dataset-card-footer-spacer|
        .dataset-card-footer-entry
          = link_to dataset_variables_path(dataset), class: 'no-underline' do
            Variables

.center= paginate @datasets, theme: 'bootstrap'

- content_for :call_to_action do
  .call-to-action
    .call-to-action-header
      Would you like to contribute a dataset?
    .call-to-action-body
      We can help you host your dataset on the NSRR, start by
      = link_to 'filling out a short form', dataset_hosting_start_path
      to learn more about the process.
