<div class="panel panel-primary">
  <div class="panel-heading">Request History</div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Date</th>
        <th>Event</th>
        <th><% if current_user.system_admin? %>By<% end %></th>
      </tr>
    </thead>
    <% @agreement.history.reverse.each do |event| %>
      <tr class="<%= 'success' if event[:status] == 'approved' %>">
        <td><%= event[:event_at].strftime("%Y-%m-%d %I:%M %p") %></td>
        <td><%= event[:message] %></td>
        <td><% if current_user.system_admin? %><%= User.find_by_id(event[:user_id]).name rescue '' %><% end %></td>
      </tr>
    <% end %>
  </table>
</div>
