- @title = "Agreements - #{@dataset.name}"

- render "themes/theme"
= render "datasets/header", container: "container-fluid"
- content_for :sidebar, render("editor/datasets/sidebar")

- content_for :breadcrumbs do
  %div{ style: "position: relative;top: 17px;" }
    = render "layouts/per_page", per_page: 100, object_count: @agreements.total_count, pagination_size: "small"
  %ol
    %li= link_to @dataset.slug, @dataset
    %li.breadcrumb-muted agreements
    - if params[:order] != "agreements.id desc" || params[:status].present?
      %li= link_to "Reset Filters", agreements_dataset_path(@dataset)

- if @agreements.present?
  .dashboard-container.dashboard-table
    %table.table.table-striped.table-borderless.table-sticky
      %col{ width: "100px" }
      %thead
        %tr
          %th
            = link_to "Status", agreements_dataset_path(@dataset, order: (params[:order] == "agreements.status desc" ? "agreements.status" : "agreements.status desc"), status: params[:status])
            .dropdown{ style: "display: inline-block" }
              = link_to icon("fas", "filter"), "#", data: { target: "#", toggle: "dropdown" }, role: "button", aria: { haspopup: "true", expanded: "false" }, id: "status-dropdown"
              .dropdown-menu{ aria: { labelledby: "status-dropdown" } }
                = link_to "All", agreements_dataset_path(@dataset, order: params[:order]), style: params[:status].blank? ? "font-weight:bold;" : "", class: "dropdown-item"
                - Agreement::STATUS.each do |label, value|
                  = link_to label.titleize, agreements_dataset_path(@dataset, order: params[:order], status: value), style: params[:status] == value ? "font-weight:bold;" : "", class: "dropdown-item"
          %th= link_to "Agreement", agreements_dataset_path(@dataset, order: (params[:order] == "agreements.id desc" ? "agreements.id" : "agreements.id desc"), status: params[:status])
      %tbody
        - @agreements.each do |agreement|
          %tr
            %td= status_helper(agreement)
            %td.nowrap
              = profile_picture_tag agreement.user, size: 18, style: "vertical-align:text-bottom;width:18px"
              = link_to agreement.name, review_path(agreement)

  .center-horizontally= paginate @agreements, theme: "bootstrap"

- else
  .jumbotron.jumbotron-custom-text
    = icon("far", "clone", class: "mr-1")
    No data requests found.
    = link_to "Start over", agreements_dataset_path(@dataset) if params[:search].present?
